import{d as B,r as S,X as T,j as A,c as C,o as E,a as h,G as U,J as Y,P as o,H as d,L as v,M as J,at as L}from"./@vue-CwWr8oRs.js";import{E as P,a as $,b as j,c as H,d as W,e as q,f as G,g as K,h as V,i as x,j as X}from"./element-plus-DqAjMvjw.js";import{u as N,w as z}from"./xlsx-Btx5Z9-G.js";import{F as Q}from"./file-saver-B8DjtjRN.js";import"./lodash-es-C-xrcuFl.js";import"./@vueuse-CxkiKrus.js";import"./@element-plus-DiUAuvwj.js";import"./@popperjs-DB1lLFnh.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-CWsDMI8D.js";import"./async-validator-CRx4dHSJ.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./@floating-ui-BCLhozDd.js";(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))_(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const g of i.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&_(g)}).observe(document,{childList:!0,subtree:!0});function t(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function _(a){if(a.ep)return;a.ep=!0;const i=t(a);fetch(a.href,i)}})();const R={class:"header"},Z=B({__name:"HelloWorld",setup(b){const l=S([]),t=T({date:"",name:"",total_money:"",performance_money:"",add_money:"",board_money:""}),_=r=>{const{columns:e,data:s}=r,n=[];return e.forEach((p,f)=>{if(f===0){n[f]="合计";return}else if(f===1){n[f]="";return}if(!s||s.length===0)return n;const u=s.map(y=>Number(y[p.property]));u.every(y=>Number.isNaN(y))||(n[f]=`${u.reduce((y,c)=>{const w=Number(c);return Number.isNaN(w)?y:y+c},0)}`)}),n},a=S(!1),i=()=>{a.value=!a.value},g=()=>{if(Object.values(t).every(e=>e!==""&&e!==null&&e!==void 0&&e!==0)){console.log(t.date);let e=-1;l.value===null&&l.value.length>0?e=0:e=l.value.findIndex(s=>s.date===t.date),e!=-1?V.confirm("检测到已有相同日期的数据，是否覆盖？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{l.value[e]={...t},localStorage.setItem("tableData",JSON.stringify(l.value)),x({type:"success",message:"数据已更新"})}):(l.value.push({...t}),localStorage.setItem("tableData",JSON.stringify(l.value)),x({type:"success",message:"新增下店记录成功"}))}else x({type:"warning",message:"数据不完整，请填写所有信息"})},O=r=>{const e=l.value.find(s=>s.date===r);t.date=r,t.name=e.name,t.total_money=e.total_money,t.performance_money=e.performance_money,t.add_money=e.add_money,t.board_money=e.board_money,a.value=!0},k=r=>{V.confirm("你确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{l.value=l.value.filter(e=>e.date!==r),localStorage.setItem("tableData",JSON.stringify(l.value)),x({type:"success",message:"删除成功"})})};A(()=>{const r=localStorage.getItem("tableData");console.log(JSON.stringify(r)),r?(l.value=JSON.parse(r),console.log(l.value)):l.value=[]});const F=()=>{V.confirm("是否确认导出数据到表格？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then(()=>{const r=[{field:"date",label:"下店时间"},{field:"name",label:"店名"},{field:"total_money",label:"总业绩(一销)"},{field:"performance_money",label:"回款业绩"},{field:"add_money",label:"加选(二销)"},{field:"board_money",label:"打板"}],e=l.value.map(u=>({下店时间:u.date,店名:u.name,"总业绩(一销)":u.total_money,回款业绩:u.performance_money,"加选(二销)":u.add_money,打板:u.board_money})),s=N.json_to_sheet(e,{header:r.map(u=>u.label)}),n=N.book_new();N.book_append_sheet(n,s,"数据报表");const p=z(n,{bookType:"xlsx",type:"binary"}),f=new Blob([I(p)],{type:"application/octet-stream"});Q.saveAs(f,"舒冰雪报表数据.xlsx")})};function I(r){const e=new ArrayBuffer(r.length),s=new Uint8Array(e);for(let n=0;n<r.length;n++)s[n]=r.charCodeAt(n)&255;return e}return(r,e)=>{const s=P,n=H,p=j,f=$,u=W,y=q,c=K,w=G;return E(),C("div",null,[h("div",R,[e[7]||(e[7]=h("span",{class:"font-bold text-2xl"},"下店数据",-1)),h("div",null,[o(s,{class:"add-btn",type:"primary",onClick:F},{default:d(()=>e[6]||(e[6]=[v(" 导出为表格")])),_:1}),o(s,{class:"add-btn",type:"primary",onClick:i},{default:d(()=>[v(J(a.value?"关闭新增":"新增下店记录"),1)]),_:1})])]),a.value?(E(),U(y,{key:0},{default:d(()=>[o(f,{model:t,style:{"margin-top":"24px"}},{default:d(()=>[o(p,{label:"店名：","label-width":"140px"},{default:d(()=>[o(n,{modelValue:t.name,"onUpdate:modelValue":e[0]||(e[0]=m=>t.name=m),style:{width:"240px"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),o(p,{label:"下店时间：","label-width":"140px"},{default:d(()=>[o(u,{modelValue:t.date,"onUpdate:modelValue":e[1]||(e[1]=m=>t.date=m),type:"date",placeholder:"选择日期",style:{width:"240px"},format:"YYYY年MM月DD日","value-format":"YYYY年MM月DD日"},null,8,["modelValue"])]),_:1}),o(p,{label:"总业绩(一销)：","label-width":"140px"},{default:d(()=>[o(n,{modelValue:t.total_money,"onUpdate:modelValue":e[2]||(e[2]=m=>t.total_money=m),style:{width:"240px"}},null,8,["modelValue"])]),_:1}),o(p,{label:"回款业绩：","label-width":"140px"},{default:d(()=>[o(n,{modelValue:t.performance_money,"onUpdate:modelValue":e[3]||(e[3]=m=>t.performance_money=m),style:{width:"240px"}},null,8,["modelValue"])]),_:1}),o(p,{label:"加选(二销)：","label-width":"140px"},{default:d(()=>[o(n,{modelValue:t.add_money,"onUpdate:modelValue":e[4]||(e[4]=m=>t.add_money=m),style:{width:"240px"}},null,8,["modelValue"])]),_:1}),o(p,{label:"打板：","label-width":"140px"},{default:d(()=>[o(n,{modelValue:t.board_money,"onUpdate:modelValue":e[5]||(e[5]=m=>t.board_money=m),style:{width:"240px"}},null,8,["modelValue"])]),_:1}),o(s,{style:{width:"200px"},type:"primary",onClick:g},{default:d(()=>e[8]||(e[8]=[v("提交")])),_:1})]),_:1})):Y("",!0),o(y,{class:"!border-none",shadow:"always"},{default:d(()=>[o(w,{data:l.value,border:"",style:{width:"100%"},"show-summary":"","summary-method":_},{default:d(()=>[o(c,{prop:"date",label:"下店时间"}),o(c,{prop:"name","show-overflow-tooltip":"",label:"店名",width:"200"}),o(c,{prop:"total_money",label:"总业绩(一销)"}),o(c,{prop:"performance_money",label:"回款业绩"}),o(c,{prop:"add_money",label:"加选(二销)"}),o(c,{prop:"board_money",label:"打板"}),o(c,{label:"操作"},{default:d(({row:m})=>[o(s,{type:"primary",onClick:M=>O(m.date)},{default:d(()=>e[9]||(e[9]=[v("修改")])),_:2},1032,["onClick"]),o(s,{type:"primary",onClick:M=>k(m.date)},{default:d(()=>e[10]||(e[10]=[v("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})])}}}),ee=(b,l)=>{const t=b.__vccOpts||b;for(const[_,a]of l)t[_]=a;return t},te=ee(Z,[["__scopeId","data-v-d04c2ed8"]]),oe={class:"app-container"},le=B({__name:"App",setup(b){return(l,t)=>(E(),C("div",oe,[o(te)]))}}),D=L(le);D.use(X);D.mount("#app");
