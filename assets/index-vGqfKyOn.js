import{d as T,r as B,X as U,j as Y,c as C,o as E,a as N,G as $,J,P as a,H as m,L as x,M as L,at as P}from"./@vue-CwWr8oRs.js";import{E as j,a as H,b as W,c as q,d as G,e as K,f as X,g as z,h as S,i as h,j as Q}from"./element-plus-DqAjMvjw.js";import{u as D,w as R}from"./xlsx-Btx5Z9-G.js";import{F as Z}from"./file-saver-B8DjtjRN.js";import"./lodash-es-C-xrcuFl.js";import"./@vueuse-CxkiKrus.js";import"./@element-plus-DiUAuvwj.js";import"./@popperjs-DB1lLFnh.js";import"./@ctrl-r5W6hzzQ.js";import"./dayjs-CWsDMI8D.js";import"./async-validator-CRx4dHSJ.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./@floating-ui-BCLhozDd.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))_(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const v of i.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&_(v)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function _(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();const ee={class:"header"},te=T({__name:"HelloWorld",setup(g){const n=B([]),t=U({date:"",name:"",total_money:"",performance_money:"",add_money:"",board_money:""}),_=s=>{const{columns:e,data:o}=s,l=[];return e.forEach((d,u)=>{if(u===0){l[u]="合计";return}else if(u===1){l[u]="";return}if(!o||o.length===0)return l;const c=o.map(y=>Number(y[d.property]));c.every(y=>Number.isNaN(y))||(l[u]=`${c.reduce((y,f)=>{const V=Number(f);return Number.isNaN(V)?y:y+f},0)}`)}),l},r=B(!1),i=()=>{r.value=!r.value,w.value=!1},v=()=>{if(Object.values(t).every(e=>e!==""&&e!==null&&e!==void 0&&e!==0)){console.log(t.date);let e=-1;n.value===null&&n.value.length>0?e=0:e=n.value.findIndex(o=>o.date===t.date),e!=-1?S.confirm("检测到已有相同日期的数据，是否覆盖？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{n.value[e]={...t},n.value.sort((o,l)=>{const d=b(o.date);return b(l.date).getTime()-d.getTime()}),localStorage.setItem("tableData",JSON.stringify(n.value)),h({type:"success",message:"数据已更新"}),i()}):(n.value.push({...t}),n.value.sort((o,l)=>{const d=b(o.date);return b(l.date).getTime()-d.getTime()}),localStorage.setItem("tableData",JSON.stringify(n.value)),h({type:"success",message:"新增下店记录成功"}))}else h({type:"warning",message:"数据不完整，请填写所有信息"})},b=s=>{const e=/(\d{4})年(\d{1,2})月(\d{1,2})日/,o=s.match(e);if(o){const l=o[1],d=o[2].padStart(2,"0"),u=o[3].padStart(2,"0");return new Date(`${l}-${d}-${u}`)}return new Date},w=B(!1),k=s=>{w.value=!0;const e=n.value.find(o=>o.date===s);t.date=s,t.name=e.name,t.total_money=e.total_money,t.performance_money=e.performance_money,t.add_money=e.add_money,t.board_money=e.board_money,r.value=!0},A=s=>{S.confirm("你确定要删除吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{const e=n.value.findIndex(o=>o.date===s);n.value.splice(e,1),n.value.sort((o,l)=>{const d=b(o.date);return b(l.date).getTime()-d.getTime()}),localStorage.setItem("tableData",JSON.stringify(n.value)),h({type:"success",message:"删除成功"})})};Y(()=>{const s=localStorage.getItem("tableData");console.log(JSON.stringify(s)),s?(n.value=JSON.parse(s),console.log(n.value)):n.value=[]});const F=()=>{S.confirm("是否确认导出数据到表格？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then(()=>{const s=[{field:"date",label:"下店时间"},{field:"name",label:"店名"},{field:"total_money",label:"总业绩(一销)"},{field:"performance_money",label:"回款业绩"},{field:"add_money",label:"加选(二销)"},{field:"board_money",label:"打板"}],e=n.value.map(c=>({下店时间:c.date,店名:c.name,"总业绩(一销)":c.total_money,回款业绩:c.performance_money,"加选(二销)":c.add_money,打板:c.board_money})),o=D.json_to_sheet(e,{header:s.map(c=>c.label)}),l=D.book_new();D.book_append_sheet(l,o,"数据报表");const d=R(l,{bookType:"xlsx",type:"binary"}),u=new Blob([I(d)],{type:"application/octet-stream"});Z.saveAs(u,"舒冰雪报表数据.xlsx")})};function I(s){const e=new ArrayBuffer(s.length),o=new Uint8Array(e);for(let l=0;l<s.length;l++)o[l]=s.charCodeAt(l)&255;return e}return(s,e)=>{const o=j,l=q,d=W,u=H,c=G,y=K,f=z,V=X;return E(),C("div",null,[N("div",ee,[e[7]||(e[7]=N("span",{class:"font-bold text-2xl"},"下店数据",-1)),N("div",null,[a(o,{class:"add-btn",type:"primary",onClick:F},{default:m(()=>e[6]||(e[6]=[x(" 导出为表格")])),_:1}),a(o,{class:"add-btn",type:"primary",onClick:i},{default:m(()=>[x(L(r.value?"关闭新增":"新增下店记录"),1)]),_:1})])]),r.value?(E(),$(y,{key:0},{default:m(()=>[a(u,{model:t,style:{"margin-top":"24px"}},{default:m(()=>[a(d,{label:"店名：","label-width":"140px"},{default:m(()=>[a(l,{modelValue:t.name,"onUpdate:modelValue":e[0]||(e[0]=p=>t.name=p),style:{width:"240px"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),a(d,{label:"下店时间：","label-width":"140px"},{default:m(()=>[a(c,{disabled:w.value,modelValue:t.date,"onUpdate:modelValue":e[1]||(e[1]=p=>t.date=p),type:"date",placeholder:"选择日期",style:{width:"240px"},format:"YYYY年MM月DD日","value-format":"YYYY年MM月DD日"},null,8,["disabled","modelValue"])]),_:1}),a(d,{label:"总业绩(一销)：","label-width":"140px"},{default:m(()=>[a(l,{modelValue:t.total_money,"onUpdate:modelValue":e[2]||(e[2]=p=>t.total_money=p),style:{width:"240px"}},null,8,["modelValue"])]),_:1}),a(d,{label:"回款业绩：","label-width":"140px"},{default:m(()=>[a(l,{modelValue:t.performance_money,"onUpdate:modelValue":e[3]||(e[3]=p=>t.performance_money=p),style:{width:"240px"}},null,8,["modelValue"])]),_:1}),a(d,{label:"加选(二销)：","label-width":"140px"},{default:m(()=>[a(l,{modelValue:t.add_money,"onUpdate:modelValue":e[4]||(e[4]=p=>t.add_money=p),style:{width:"240px"}},null,8,["modelValue"])]),_:1}),a(d,{label:"打板：","label-width":"140px"},{default:m(()=>[a(l,{modelValue:t.board_money,"onUpdate:modelValue":e[5]||(e[5]=p=>t.board_money=p),style:{width:"240px"}},null,8,["modelValue"])]),_:1}),a(o,{style:{width:"200px"},type:"primary",onClick:v},{default:m(()=>e[8]||(e[8]=[x("提交")])),_:1})]),_:1})):J("",!0),a(y,{class:"!border-none",shadow:"always"},{default:m(()=>[a(V,{data:n.value,border:"",style:{width:"100%"},"show-summary":"","summary-method":_},{default:m(()=>[a(f,{prop:"date",label:"下店时间"}),a(f,{prop:"name","show-overflow-tooltip":"",label:"店名",width:"200"}),a(f,{prop:"total_money",label:"总业绩(一销)"}),a(f,{prop:"performance_money",label:"回款业绩"}),a(f,{prop:"add_money",label:"加选(二销)"}),a(f,{prop:"board_money",label:"打板"}),a(f,{label:"操作"},{default:m(({row:p})=>[a(o,{type:"primary",onClick:M=>k(p.date)},{default:m(()=>e[9]||(e[9]=[x("修改")])),_:2},1032,["onClick"]),a(o,{type:"primary",onClick:M=>A(p.date)},{default:m(()=>e[10]||(e[10]=[x("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1})])}}}),oe=(g,n)=>{const t=g.__vccOpts||g;for(const[_,r]of n)t[_]=r;return t},ae=oe(te,[["__scopeId","data-v-40c564a5"]]),le={class:"app-container"},ne=T({__name:"App",setup(g){return(n,t)=>(E(),C("div",le,[a(ae)]))}}),O=P(ne);O.use(Q);O.mount("#app");
